generator client {
    provider = "prisma-client-js"
    output   = "./generated"
}

datasource db {
    provider = "mongodb"
    url      = env("DATABASE_URL")
}

model User {
    id              String          @id @default(auto()) @map("_id") @db.ObjectId
    name            String
    email           String          @unique
    providerName    String
    providerUserId  String
    forms           Form[]          @relation("UserForms")

    @@unique([providerName, providerUserId])
}

model Form {
    id                          String          @id @map("_id") @default(auto()) @db.ObjectId
    title                       String
    description                 String
    settings                    Json
    fields                      Json
    fieldSettings               Json
    fieldRules                  Json
    fieldOptions                Json
    respondentCategories        Json
    respondentCategoryRules     Json
    createdAt                   DateTime        @default(now())

    responses                   FormResponse[]  @relation("FormResponses")

    userId                      String          @db.ObjectId
    user                        User            @relation("UserForms", fields: [userId], references: [id])
}

model FormResponse {
    id              String          @id @map("_id") @default(auto()) @db.ObjectId
    email           String?
    submission      DateTime        @default(now())
    responses       Json
    categoryRules   Json

    formId          String          @db.ObjectId
    form            Form            @relation("FormResponses", fields: [formId], references: [id])
}
